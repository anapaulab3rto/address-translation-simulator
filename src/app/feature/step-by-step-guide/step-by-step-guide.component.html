<div class="guide-container">
  <header>
    <h1>Tradução de Endereço Virtual</h1>
    <p><i>Ao realizar traduções os valores de exemplo serão adaptados</i></p>
  </header>
  <main>
    <section class="step">
      <h2>Dados Iniciais</h2>
      <ul>
        <li><strong>Endereço Virtual:</strong> {{binarioParaDecimal(addr())}}</li>
        <li><strong>Tamanho da Página:</strong> {{w()}} bytes</li>
        <li><strong>Espaço de Endereçamento:</strong> {{x()}} bytes</li>
        <li><strong>Total de Bits do Endereço:</strong> {{y()}} (pois 2<sup>{{y()}}</sup> = {{x()}})</li>
      </ul>
    </section>

    <section class="step">
      <h2>Passo 1: Converter Endereço Virtual para Binário</h2>
      <p>
        O primeiro passo é converter o endereço virtual decimal em sua representação binária, usando o total de <strong>{{y()}} bits</strong> definidos pelo espaço de endereçamento.
      </p>
      <div class="conversion-visual">
        <span class="decimal">{{binarioParaDecimal(addr())}}</span>
        <span class="arrow">→</span>
        <span class="binary">{{ addr() }}</span>
      </div>
    </section>

    <section class="step">
      <h2>Passo 2: Dividir Endereço Binário em VPN e Offset</h2>
      <p>O endereço virtual binário é dividido em um <strong>Número da Página (VPN)</strong> e um <strong>Deslocamento (Offset)</strong>.</p>
      <p>Sabemos que a página tem {{w()}} bytes. Para separar o VPN do Offset, atribuímos ao VPN a quantidade de bits necessários para representar o número total de páginas ({{x()/w()}}), e o restante dos bits se torna o Offset.</p>
      <div class="address-visual">
        <div class="address-part page-number" title="Número da Página Virtual">{{vpn()}}</div>
        <div class="address-part offset" title="Offset">{{offset()}}</div>
      </div>
    </section>

    <section class="step">
      <h2>Passo 3: Consultar a Tabela de Páginas</h2>
       <p>Acessamos a Tabela de Páginas usando o VPN como índice e verificamos o Número do Quadro (Frame Number) onde a página está armazenada na memória física.</p>
      <div class="flow-diagram">
        <div class="element">VPN ({{vpn()}})</div>
        <div class="arrow">&rarr;</div>
        <div class="element table">Tabela de Páginas</div>
        <div class="arrow">&rarr;</div>
        <div class="element frame">Quadro ({{f() ?? '?'}})</div>
      </div>
    </section>

    <section class="step">
      <h2>Passo 4: Tratamento de Page Fault</h2>
      <p>Se a entrada na tabela (PTE) for inválida, ocorre um <strong>page fault</strong>.</p>
      <p>O Sistema Operacional procura um quadro livre na memória. Se a memória estiver cheia, a <strong>política de substituição de páginas</strong> é acionada para liberar um quadro. A Tabela de Páginas é então atualizada para a página nova (valid=true) e para a página vítima (valid=false).</p>
    </section>

    <section class="step">
      <h2>Passo 5: Formar o Endereço Físico</h2>
      <p>O endereço físico final é formado pela combinação do <strong>Número do Quadro ({{f()}})</strong> obtido da tabela com o <strong>Offset ({{offset()}})</strong> original do endereço virtual.</p>
      <div class="address-visual">
        <div class="address-part frame-number" title="Número do Quadro">{{f()}}</div>
        <div class="address-part offset" title="Offset">{{offset()}}</div>
      </div>
    </section>
  </main>
  <footer>
    <p>Baseado nos conceitos do livro: <em>Operating Systems: Three Easy Pieces</em>.</p>
  </footer>
</div>
